<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE application [<!ENTITY % common  SYSTEM "../../common/common.ent">
%common;]>
<section xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude"
    xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="sharing-images">
    <title>Sharing images</title>
    <para>The &CImA; allows users to share images they have created with others and to use images created by someone else. To
        learn more about the fundamentals of image sharing, see <olink targetdoc="ci-gettingstarted"
            targetptr="image-sharing">“Image Sharing”</olink>. The following examples show some basic image sharing
        operations with cURL examples. </para>
    <itemizedlist>
        <listitem>
            <para><olink targetdoc="ci-gettingstarted" targetptr="create-image-member">“Create an image
                member”</olink></para>
        </listitem>
        <listitem>
            <para><olink targetdoc="ci-gettingstarted" targetptr="list-image-member">“List image members”</olink></para>
        </listitem>
        <listitem>
            <para><olink targetdoc="ci-gettingstarted" targetptr="detail-image-member">“Get image member
                details”</olink></para>
        </listitem>
        <listitem>
            <para><olink targetdoc="ci-gettingstarted" targetptr="update-image-member">“Update an image
                member”</olink></para>
        </listitem>
        <listitem>
            <para><olink targetdoc="ci-gettingstarted" targetptr="delete-image-member">“Delete an image
                member”</olink></para>
        </listitem>
    </itemizedlist>
    <section xml:id="create-image-member" xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude"
        xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0">
        <title>Create an image member</title>
        <para>To share an image with a particular user, you need to know who the user is, create an image member for that
            user, and associate the image member with the image.</para>
        <procedure>
            <title>To create an image member with cURL</title>
            <step>
                <para>Issue the following cURL command to create an image member for an image. In this example, we share the
                    image <literal>a96be11e-8536-4910-92cb-de50aa19dfe6</literal>, which we created, with user
                        <literal>8989447062e04a818baf9e073fd04fa7</literal>. Possibly we blogged about our image, and the
                    user emailed us requesting access, so we know his user ID.</para>
                <programlisting>
curl -s https://iad.images.api.rackspacecloud.com/v2/$account/images/a96be11e-8536-4910-92cb-de50aa19dfe6/members \
-d '{"member":"8989447062e04a818baf9e073fd04fa7"}' -H "X-Auth-Token: $token" |python -m json.tool
                </programlisting>
                <para><emphasis role="bold">Options:</emphasis>
                    <itemizedlist>
                        <listitem>
                            <para><emphasis role="bold">-s</emphasis>: Runs the command in silent mode.</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">-H</emphasis>: Specified header information. In this case, it
                                provides the authentication token. If you previously exported the token environment variable
                                in <olink targetdoc="ci-gettingstarted" targetptr="export-curl-vars">“Exporting cURL
                                    Environment Variables”</olink>, you can use the <parameter>$token</parameter> variable.
                                Otherwise, substitute your actual token for the variable.</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">-d</emphasis>: Specifies the JSON request body.</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">-m json.tool</emphasis>: Specifies the json.tool, which pretty-prints
                                the json output. For more information about the json.tool, see <olink
                                    targetdoc="ci-gettingstarted" targetptr="json_tool">json.tool</olink>.</para>
                        </listitem>
                    </itemizedlist>
                </para>
                <para>The command returns the following response.</para>
                <example>
                    <title>Create an image member with cURL response</title>
                    <programlisting language="json">
{
    "created_at": "2013-09-20T19:22:19Z",
    "image_id": "a96be11e-8536-4910-92cb-de50aa19dfe6",
    "member_id": "8989447062e04a818baf9e073fd04fa7",
    "schema": "/v2/schemas/member",
    "status": "pending",
    "updated_at": "2013-09-20T19:25:31Z"
}
                    </programlisting>
                </example>
            </step>
        </procedure>
    </section>
    <section xml:id="list-image-member" xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude"
        xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0">
        <title>List image members</title>
        <para>If you want to see everyone with whom you've shared an image and the status of each member, list the image
            members.</para>
        <procedure>
            <title>To list image members with cURL</title>
            <step>
                <para>Issue the following cURL command to list the image members for an image. In this example, we list
                    members for image <literal>a96be11e-8536-4910-92cb-de50aa19dfe6</literal>.</para>
                <programlisting>
curl -s https://iad.images.api.rackspacecloud.com/v2/$account/images/a96be11e-8536-4910-92cb-de50aa19dfe6/members \
-H "X-Auth-Token: $token" |python -m json.tool
                </programlisting>
                <para><emphasis role="bold">Options:</emphasis>
                    <itemizedlist>
                        <listitem>
                            <para><emphasis role="bold">-s</emphasis>: Runs the command in silent mode.</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">-H</emphasis>: Specified header information. In this case, it
                                provides the authentication token. If you previously exported the token environment variable
                                in <olink targetdoc="ci-gettingstarted" targetptr="export-curl-vars">“Exporting cURL
                                    Environment Variables”</olink>, you can use the <parameter>$token</parameter> variable.
                                Otherwise, substitute your actual token for the variable.</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">-m json.tool</emphasis>: Specifies the json.tool, which pretty-prints
                                the json output. For more information about the json.tool, see <olink
                                    targetdoc="ci-gettingstarted" targetptr="json_tool">json.tool</olink>.</para>
                        </listitem>
                    </itemizedlist>
                </para>
                <para>The command returns the following response.</para>
                <example>
                    <title>List image members with cURL response</title>
                    <programlisting language="json">
{
    "members": [
        {
            "created_at": "2013-10-07T17:58:03Z",
            "image_id": "a96be11e-8536-4910-92cb-de50aa19dfe6",
            "member_id": "123456789",
            "schema": "/v2/schemas/member",
            "status": "pending",
            "updated_at": "2013-10-07T17:58:03Z"
        },
        {
            "created_at": "2013-10-07T17:58:55Z",
            "image_id": "a96be11e-8536-4910-92cb-de50aa19dfe6",
            "member_id": "987654321",
            "schema": "/v2/schemas/member",
            "status": "accepted",
            "updated_at": "2013-10-08T12:08:55Z"
        }
    ],
    "schema": "/v2/schemas/members"
}
                    </programlisting>
                </example>
            </step>
        </procedure>
    </section>
    <section xml:id="detail-image-member" xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude"
        xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0">
        <title>Get image member details</title>
        <para>If you want to see details for a specific image member, get the image member's details.</para>
        <procedure>
            <title>To get an image member's details with cURL</title>
            <step>
                <para>Issue the following cURL command to get the image member's details. In this example, we list member's
                    details for image <literal>a96be11e-8536-4910-92cb-de50aa19dfe6</literal> and member
                        <literal>123456789</literal>.</para>
                <programlisting>
curl -s https://iad.images.api.rackspacecloud.com/v2/$account/images/a96be11e-8536-4910-92cb-de50aa19dfe6/members/123456789 \
-H "X-Auth-Token: $token" |python -m json.tool
                </programlisting>
                <para><emphasis role="bold">Options:</emphasis>
                    <itemizedlist>
                        <listitem>
                            <para><emphasis role="bold">-s</emphasis>: Runs the command in silent mode.</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">-H</emphasis>: Specified header information. In this case, it
                                provides the authentication token. If you previously exported the token environment variable
                                in <olink targetdoc="ci-gettingstarted" targetptr="export-curl-vars">“Exporting cURL
                                    Environment Variables”</olink>, you can use the <parameter>$token</parameter> variable.
                                Otherwise, substitute your actual token for the variable.</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">-m json.tool</emphasis>: Specifies the json.tool, which pretty-prints
                                the json output. For more information about the json.tool, see <olink
                                    targetdoc="ci-gettingstarted" targetptr="json_tool">json.tool</olink>.</para>
                        </listitem>
                    </itemizedlist>
                </para>
                <para>The command returns the following response.</para>
                <example>
                    <title>Get an image member's details with cURL response</title>
                    <programlisting language="json">
{
    "members":
        {
            "created_at": "2013-10-07T17:58:03Z",
            "image_id": "a96be11e-8536-4910-92cb-de50aa19dfe6",
            "member_id": "123456789",
            "schema": "/v2/schemas/member",
            "status": "pending",
            "updated_at": "2013-10-07T17:58:03Z"
        },
    "schema": "/v2/schemas/members"
}
                    </programlisting>
                </example>
            </step>
        </procedure>
    </section>
    <section xml:id="update-image-member" xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude"
        xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0">
        <title>Update an image member</title>
        <para>If sent a request to someone asking for access to their image outside of this API process, that image producer
            creates an image member with your tenant ID using <olink targetdoc="ci-gettingstarted"
                targetptr="create-image-member">“Create an image member”</olink>. You must update the image member for the
            image to accept or reject the offer of the shared image.</para>
        <procedure>
            <title>To update an image member with cURL</title>
            <step>
                <para>Issue the following cURL command to update an image member for an image. In this example, we accept
                    offer of the shared image <literal>a96be11e-8536-4910-92cb-de50aa19dfe6</literal>.</para>
                <programlisting>
curl -s https://iad.images.api.rackspacecloud.com/v2/$account/images/a96be11e-8536-4910-92cb-de50aa19dfe6/members/8989447062e04a818baf9e073fd04fa7 \
-d '{"status":"accepted"}' -H "X-Auth-Token: $token" |python -m json.tool
                </programlisting>
                <para><emphasis role="bold">Options:</emphasis>
                    <itemizedlist>
                        <listitem>
                            <para><emphasis role="bold">-s</emphasis>: Runs the command in silent mode.</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">-H</emphasis>: Specified header information. In this case, it
                                provides the authentication token. If you previously exported the token environment variable
                                in <olink targetdoc="ci-gettingstarted" targetptr="export-curl-vars">“Exporting cURL
                                    Environment Variables”</olink>, you can use the <parameter>$token</parameter> variable.
                                Otherwise, substitute your actual token for the variable.</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">-d</emphasis>: Specifies the JSON request body.</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">-m json.tool</emphasis>: Specifies the json.tool, which pretty-prints
                                the json output. For more information about the json.tool, see <olink
                                    targetdoc="ci-gettingstarted" targetptr="json_tool">json.tool</olink>.</para>
                        </listitem>
                    </itemizedlist>
                </para>
                <para>The command returns the following response.</para>
                <example>
                    <title>Update an image member with cURL response</title>
                    <programlisting language="json">
{
    "created_at": "2013-09-20T19:22:19Z",
    "image_id": "a96be11e-8536-4910-92cb-de50aa19dfe6",
    "member_id": "8989447062e04a818baf9e073fd04fa7",
    "schema": "/v2/schemas/member",
    "status": "accepted",
    "updated_at": "2013-09-20T20:15:31Z"
}
                    </programlisting>
                </example>
            </step>
        </procedure>
    </section>
    <section xml:id="delete-image-member" xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude"
        xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0">
        <title>Delete an image member</title>
        <para>If you decide to no longer share your image with a user, you need to delete that image member.</para>
        <procedure>
            <title>To delete an image member with cURL</title>
            <step>
                <para>Issue the following cURL command to delete an image member for an image. In this example, we delete the
                    user <literal>8989447062e04a818baf9e073fd04fa7</literal>, so that the user can no longer share the image
                        <literal>a96be11e-8536-4910-92cb-de50aa19dfe6</literal>.</para>
                <programlisting>
curl -s https://iad.images.api.rackspacecloud.com/v2/$account/images/a96be11e-8536-4910-92cb-de50aa19dfe6/members/8989447062e04a818baf9e073fd04fa7 \
-H "X-Auth-Token: $token" |python -m json.tool
                </programlisting>
                <para><emphasis role="bold">Options:</emphasis>
                    <itemizedlist>
                        <listitem>
                            <para><emphasis role="bold">-s</emphasis>: Runs the command in silent mode.</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">-H</emphasis>: Specified header information. In this case, it
                                provides the authentication token. If you previously exported the token environment variable
                                in <olink targetdoc="ci-gettingstarted" targetptr="export-curl-vars">“Exporting cURL
                                    Environment Variables”</olink>, you can use the <parameter>$token</parameter> variable.
                                Otherwise, substitute your actual token for the variable.</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">-m json.tool</emphasis>: Specifies the json.tool, which pretty-prints
                                the json output. For more information about the json.tool, see <olink
                                    targetdoc="ci-gettingstarted" targetptr="json_tool">json.tool</olink>.</para>
                        </listitem>
                    </itemizedlist>
                </para>
                <para>If it is successful, the command returns an <errorcode>204</errorcode> with no response body.</para>
            </step>
        </procedure>
    </section>
</section>
